"CD68 protein\nvs. macrophages",
"CD66b protein\nvs. neutrophils",
"SMA protein\nvs. fibroblasts"))
plotdf$method[plotdf$method == "outliers.removed"] = "Outliers removed"
plotdf$method[plotdf$method == "outliers.retained"] = "Outliers retained"
plotdf$method
colmap = c(
"Outliers removed" = "cornflowerblue",
"Outliers retained" = "orange")
use = (plotdf$stat == "cors")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
#scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
#scale_fill_manual(values = colmap) +
#scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
plotdf$method[plotdf$method == "t2"] = "Threshold = 2"
plotdf$method[plotdf$method == "t3"] = "Threshold = 3"
plotdf$method[plotdf$method == "t4"] = "Threshold = 4"
plotdf$method[plotdf$method == "t5"] = "Threshold = 5"
plotdf$method[plotdf$method == "t6"] = "Threshold = 6"
plotdf$method[plotdf$method == "tinf"] = "Outliers retained"
plotdf$method = factor(plotdf$method, levels = c(paste0("t", 2:6), "Outliers retained"))
use = (plotdf$stat == "cors")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
#scale_fill_manual(values = colmap) +
#scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
plotdf$method
plotdf = data.frame(method = method, tissue = tissue, protein = protein, stat = stat, value = value)
# custom names
plotdf$protein[plotdf$protein == "CD20"] = "CD20 protein\nvs. B-cells"
plotdf$protein[plotdf$protein == "CD3"] = "CD3 protein\nvs. total T-cells"
plotdf$protein[plotdf$protein == "CD8"] = "CD8 protein\nvs. CD8 T-cells"
plotdf$protein[plotdf$protein == "CD68"] = "CD68 protein\nvs. macrophages"
plotdf$protein[plotdf$protein == "CD66b"] = "CD66b protein\nvs. neutrophils"
plotdf$protein[plotdf$protein == "SMA"] = "SMA protein\nvs. fibroblasts"
plotdf$tumor = paste0("Tumor ", 1:5)[as.numeric(as.factor(plotdf$tissue))]
plotdf$protein = factor(plotdf$protein,
levels = c("CD3 protein\nvs. total T-cells",
"CD8 protein\nvs. CD8 T-cells",
"CD20 protein\nvs. B-cells",
"CD68 protein\nvs. macrophages",
"CD66b protein\nvs. neutrophils",
"SMA protein\nvs. fibroblasts"))
plotdf$method[plotdf$method == "t2"] = "Threshold = 2"
plotdf$method[plotdf$method == "t3"] = "Threshold = 3"
plotdf$method[plotdf$method == "t4"] = "Threshold = 4"
plotdf$method[plotdf$method == "t5"] = "Threshold = 5"
plotdf$method[plotdf$method == "t6"] = "Threshold = 6"
plotdf$method[plotdf$method == "tinf"] = "Outliers retained"
plotdf$method = factor(plotdf$method, levels = c(paste0("t", 2:6), "Outliers retained"))
use = (plotdf$stat == "cors")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
#scale_fill_manual(values = colmap) +
#scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
plotdf$method
plotdf = data.frame(method = method, tissue = tissue, protein = protein, stat = stat, value = value)
# custom names
plotdf$protein[plotdf$protein == "CD20"] = "CD20 protein\nvs. B-cells"
plotdf$protein[plotdf$protein == "CD3"] = "CD3 protein\nvs. total T-cells"
plotdf$protein[plotdf$protein == "CD8"] = "CD8 protein\nvs. CD8 T-cells"
plotdf$protein[plotdf$protein == "CD68"] = "CD68 protein\nvs. macrophages"
plotdf$protein[plotdf$protein == "CD66b"] = "CD66b protein\nvs. neutrophils"
plotdf$protein[plotdf$protein == "SMA"] = "SMA protein\nvs. fibroblasts"
plotdf$tumor = paste0("Tumor ", 1:5)[as.numeric(as.factor(plotdf$tissue))]
plotdf$protein = factor(plotdf$protein,
levels = c("CD3 protein\nvs. total T-cells",
"CD8 protein\nvs. CD8 T-cells",
"CD20 protein\nvs. B-cells",
"CD68 protein\nvs. macrophages",
"CD66b protein\nvs. neutrophils",
"SMA protein\nvs. fibroblasts"))
plotdf$method
plotdf$method[plotdf$method == "t2"]
plotdf$method[plotdf$method == "t2"] = "Threshold = 2"
plotdf$method
plotdf$method[plotdf$method == "t3"] = "Threshold = 3"
plotdf$method[plotdf$method == "t4"] = "Threshold = 4"
plotdf$method[plotdf$method == "t5"] = "Threshold = 5"
plotdf$method[plotdf$method == "t6"] = "Threshold = 6"
plotdf$method[plotdf$method == "tinf"] = "Outliers retained"
plotdf$method = factor(plotdf$method, levels = c(paste0("Threshold = ", 2:6), "Outliers retained"))
use = (plotdf$stat == "cors")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
#scale_fill_manual(values = colmap) +
#scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
svg("serial sections - accuracy vs outlier threshold.svg", width = 9, height = 9)
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
#scale_fill_manual(values = colmap) +
#scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
dev.off()
cors
sapply(cors,mean)
t.test(as.vector(cors[["t3"]]) - as.vector(cors[["t2"]]))
t.test(as.vector(cors[["t3"]]) - as.vector(cors[["tinf"]]))
sapply(cors,mean)
t.test(as.vector(cors[["t3"]]) - as.vector(cors[["t4"]]))
t.test(as.vector(cors[["t3"]]) - as.vector(cors[["t5"]]))
t.test(as.vector(cors[["t3"]]) - as.vector(cors[["t6"]]))
t.test(as.vector(cors[["t3"]]) - as.vector(cors[["t2"]]))
colnames(annot)
colmap = c(
"Threshold = 2" = "red",
"Threshold = 3" = "orange",
"Threshold = 4" = "cornflowerblue",
"Threshold = 5" = "dodgerblue2",
"Threshold = 6" = "dodgerblue4",
"Outliers retained" = "grey30")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
colmap = c(
"Threshold = 2" = "red",
"Threshold = 3" = "orange",
"Threshold = 4" = "chartreuse3",
"Threshold = 5" = "dodgerblue2",
"Threshold = 6" = "dodgerblue4",
"Outliers retained" = "grey30")
use = (plotdf$stat == "cors")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
colmap = c(
"Threshold = 2" = "red",
"Threshold = 3" = "orange",
"Threshold = 4" = "dodgerblue2",
"Threshold = 5" = "dodgerblue2",
"Threshold = 6" = "dodgerblue4",
"Outliers retained" = "grey30")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
colmap = c(
"Threshold = 2" = "red",
"Threshold = 3" = "orange",
"Threshold = 4" = "cornflowerblue",
"Threshold = 5" = "dodgerblue4",
"Threshold = 6" = "darkviolet",
"Outliers retained" = "grey30")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
colmap = c(
"Threshold = 2" = "red",
"Threshold = 3" = "orange",
"Threshold = 4" = "cornflowerblue",
"Threshold = 5" = "dodgerblue4",
"Threshold = 6" = "darkviolet3",
"Outliers retained" = "grey30")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
colmap = c(
"Threshold = 2" = "darkviolet",
"Threshold = 3" = "red",
"Threshold = 4" = "orange",
"Threshold = 5" = "cornflowerblue",
"Threshold = 6" = "dodgerblue4",
"Outliers retained" = "grey30")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
colmap = c(
"Threshold = 2" = "darkviolet",
"Threshold = 3" = "red",
"Threshold = 4" = "darkgoldenrod4",
"Threshold = 5" = "cornflowerblue",
"Threshold = 6" = "dodgerblue4",
"Outliers retained" = "grey30")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
colmap = c(
"Threshold = 2" = "darkviolet",
"Threshold = 3" = "red",
"Threshold = 4" = "darkgoldenrod3",
"Threshold = 5" = "cornflowerblue",
"Threshold = 6" = "dodgerblue4",
"Outliers retained" = "grey30")
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
use = (plotdf$stat == "cors")
svg("serial sections - accuracy vs outlier threshold.svg", width = 9, height = 9)
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Method", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
dev.off()
names(cors)
names(cors)[order(names(cors))]
o = order(names(cors))
par(mfrow = c(2,3))
for (tiss in rownames(cors[[1]])) {
cols = brewer.pal(7, "Set1")[-6]
names(cols) = colnames(cors[[1]])
plot(c(0,0), xlim = range(ratios), ylim = range(unlist(cors)), col = 0, log = "x",
xlab = "Ratio to default epsilon", ylab = "Correlation with protein",
cex.lab = 1.5, main = paste0("Sample ", tiss))
for (prot in colnames(cors[[1]])) {
tempcors = c()
for (i in 1:length(cors)) {
tempcors[i] = cors[[i]][tiss, prot]
}
lines(ratios[o], tempcors[o], col = cols[prot])
points(ratios[o], tempcors[o], col = cols[prot], pch = 16)
}
abline(v = 1, lty = 2)
}
plot(c(0,0), xlim = c(1, length(cors)), ylim = range(unlist(cors)), col = 0, log = "x",
xlab = "Ratio to default epsilon", ylab = "Correlation with protein",
cex.lab = 1.5, main = paste0("Sample ", tiss))
tempcors = c()
for (i in 1:length(cors)) {
tempcors[i] = cors[[i]][tiss, prot]
}
lines(1:length(cors), tempcors[o], col = cols[prot])
points(1:length(cors), tempcors[o], col = cols[prot], pch = 16)
prot
for (prot in colnames(cors[[1]])) {
tempcors = c()
for (i in 1:length(cors)) {
tempcors[i] = cors[[i]][tiss, prot]
}
lines(1:length(cors), tempcors[o], col = cols[prot])
points(1:length(cors), tempcors[o], col = cols[prot], pch = 16)
}
abline(v = 1, lty = 2)
plot(c(0,0), xlim = c(1, length(cors)), ylim = range(unlist(cors)), col = 0,
xlab = "Ratio to default epsilon", ylab = "Correlation with protein",
cex.lab = 1.5, main = paste0("Sample ", tiss))
for (prot in colnames(cors[[1]])) {
tempcors = c()
for (i in 1:length(cors)) {
tempcors[i] = cors[[i]][tiss, prot]
}
lines(1:length(cors), tempcors[o], col = cols[prot])
points(1:length(cors), tempcors[o], col = cols[prot], pch = 16)
}
plot(c(0,0), xlim = c(1, length(cors)), ylim = range(unlist(cors)), col = 0,
xlab = "Ratio to default epsilon", ylab = "Correlation with protein",
cex.lab = 1.5, main = paste0("Sample ", tiss), xaxt = "n")
axis(1, 1:length(cors), names(cors)[o])
o = order(names(cors))
par(mfrow = c(2,3))
for (tiss in rownames(cors[[1]])) {
cols = brewer.pal(7, "Set1")[-6]
names(cols) = colnames(cors[[1]])
plot(c(0,0), xlim = c(1, length(cors)), ylim = range(unlist(cors)), col = 0,
xlab = "Ratio to default epsilon", ylab = "Correlation with protein",
cex.lab = 1.5, main = paste0("Sample ", tiss), xaxt = "n")
axis(1, 1:length(cors), names(cors)[o])
for (prot in colnames(cors[[1]])) {
tempcors = c()
for (i in 1:length(cors)) {
tempcors[i] = cors[[i]][tiss, prot]
}
lines(1:length(cors), tempcors[o], col = cols[prot])
points(1:length(cors), tempcors[o], col = cols[prot], pch = 16)
}
abline(v = 2, lty = 2)
}
frame()
legend("center", lty = 2, pch = c(rep(16, length(cols)), NA),
col = c(cols, 1),
legend = c(names(cols), "default epsilon"), cex = 1.5)
boxplot(nflagged ~ is.element(usegenes, to.perturb), ylab = "Proportion of AOIs where gene is flagged",
xlab = "", names = c("Unperturbed\n(494 genes)", "Added noise\n(50 genes)"), cex.lab = 1.5, outline = F)
points(1 + jitter(as.numeric(is.element(usegenes, to.perturb))), nflagged, pch = 16, col = alpha("darkblue", 0.7))
svg("rate of outlier removal.svg", width = 4.5)
boxplot(nflagged ~ is.element(usegenes, to.perturb), ylab = "Proportion of regions where gene is flagged",
xlab = "", names = c("Unperturbed\n(494 genes)", "Added noise\n(50 genes)"), cex.lab = 1.5, outline = F)
points(1 + jitter(as.numeric(is.element(usegenes, to.perturb))), nflagged, pch = 16, col = alpha("darkblue", 0.7))
dev.off()
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Outlier removal rule", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
svg("serial sections - with vs. without outliers.svg", width = 9, height = 9)
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Outlier removal rule", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
dev.off()
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Outlier removal rule", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
svg("serial sections - accuracy vs outlier threshold.svg", width = 9, height = 9)
g = ggplot(data = plotdf[use, ], aes(x = method, y = value, fill = method, col = method, )) +
geom_bar(alpha = 0.5, size = 1, stat = "identity") +
theme_few() +
facet_grid(tumor ~ protein, scales = "free") +
scale_y_continuous(limits=c(-0.45, 1)) +
scale_x_discrete(labels = NULL) +
scale_fill_manual(values = colmap) +
scale_color_manual(values = colmap, ) +
labs(x = "Outlier removal rule", y = "Correlation") +
theme(axis.title.x = element_text(size = 17), axis.title.y = element_text(size = 17),
strip.text.x = element_text(size = 12), strip.text.y = element_text(size = 12),
legend.title = element_blank()) +
theme(legend.position="bottom") + theme(legend.text = element_text(size=16))
print(g)
dev.off()
